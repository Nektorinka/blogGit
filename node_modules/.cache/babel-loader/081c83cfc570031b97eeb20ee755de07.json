{"ast":null,"code":"import _regeneratorRuntime from\"/Users/apple/Documents/GIT/blogGit/blogGit/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/apple/Documents/GIT/blogGit/blogGit/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/apple/Documents/GIT/blogGit/blogGit/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{connect}from'react-redux';import{Link,withRouter,Redirect}from'react-router-dom';import{useForm}from'react-hook-form';import'./signUp.scss';import{Alert}from'antd';import*as actions from'../../Redux/Actions/actions';import ServiceApi from'../../services/serviceApi';import{renderErrors}from'./formsFunctions';function SignIn(_ref){var logIn=_ref.logIn,setErrorInMain=_ref.setErrorInMain,mainState=_ref.mainState,history=_ref.history;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),sucsessLog=_useState2[0],setSucsessLog=_useState2[1];var _useForm=useForm(),register=_useForm.register,handleSubmit=_useForm.handleSubmit,errors=_useForm.errors;var myService=new ServiceApi();function onSubmit(_x){return _onSubmit.apply(this,arguments);}function _onSubmit(){_onSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){var response,_response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return myService.sigIn({user:{email:data.email,password:data.password}});case 3:response=_context.sent;if(!response.errors){_context.next=8;break;}return _context.abrupt(\"return\",setErrorInMain(response.errors));case 8:logIn(response);setSucsessLog(true);return _context.abrupt(\"return\",setTimeout(function(){history.push('/');},1500));case 11:_context.next=25;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](0);_context.next=17;return myService.sigIn({user:{email:data.email,password:data.password}});case 17:_response=_context.sent;if(!_response.errors){_context.next=22;break;}return _context.abrupt(\"return\",setErrorInMain(_response.errors));case 22:logIn(_response);setSucsessLog(true);return _context.abrupt(\"return\",setTimeout(function(){history.push('/');},1500));case 25:case\"end\":return _context.stop();}}},_callee,null,[[0,13]]);}));return _onSubmit.apply(this,arguments);}return/*#__PURE__*/React.createElement(\"div\",{className:\"sign_up\"},/*#__PURE__*/React.createElement(\"form\",{onSubmit:handleSubmit(onSubmit),className:\"sign_up_form form\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form__header-container\"},/*#__PURE__*/React.createElement(\"h1\",{className:\"form__header\"},\"Sign In\")),/*#__PURE__*/React.createElement(\"label\",{className:\"form__input-group\"},/*#__PURE__*/React.createElement(\"span\",{className:\"form__input-label\"},\"Email address\"),/*#__PURE__*/React.createElement(\"input\",{autoFocus:true,type:\"email\",name:\"email\",placeholder:\"Email address\",className:\"form__input\",ref:register({required:'Введите email',pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,}$/i,message:'Введите корректный email'}})}),errors.email&&/*#__PURE__*/React.createElement(\"span\",{className:\"form__input-label form__input-label--error\"},errors.email.message)),/*#__PURE__*/React.createElement(\"label\",{className:\"form__input-group\"},/*#__PURE__*/React.createElement(\"span\",{className:\"form__input-label\"},\"Password\"),/*#__PURE__*/React.createElement(\"input\",{type:\"password\",name:\"password\",placeholder:\"Password\",className:\"form__input\",ref:register({required:'Введите пароль',minLength:{value:6,message:'Пароль должен быть от 6 до 40 символов'},maxLength:{value:40,message:'Пароль должен быть от 6 до 40 символов'}})}),errors.password&&/*#__PURE__*/React.createElement(\"span\",{className:\"form__input-label form__input-label--error\"},errors.password.message)),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"form__submit\"},\"Login\"),/*#__PURE__*/React.createElement(\"div\",{className:\"form__container\"},/*#__PURE__*/React.createElement(\"span\",{className:\"form__text\"},\"Don't have an account?\",' ',/*#__PURE__*/React.createElement(Link,{className:\"form__link\",to:\"/sign-up\"},\"Sign In.\"))),sucsessLog?/*#__PURE__*/React.createElement(Alert,{message:\"Success\",type:\"success\",style:{marginBottom:'20px'}}):null,mainState.error?renderErrors(mainState.error):null));}var mapStateToProps=function mapStateToProps(state){return{mainState:state.mainReducer};};export default withRouter(connect(mapStateToProps,actions)(SignIn));","map":{"version":3,"sources":["/Users/apple/Documents/GIT/blogGit/blogGit/src/components/Forms/SignIn.jsx"],"names":["React","useEffect","useState","connect","Link","withRouter","Redirect","useForm","Alert","actions","ServiceApi","renderErrors","SignIn","logIn","setErrorInMain","mainState","history","sucsessLog","setSucsessLog","register","handleSubmit","errors","myService","onSubmit","data","sigIn","user","email","password","response","setTimeout","push","required","pattern","value","message","minLength","maxLength","marginBottom","error","mapStateToProps","state","mainReducer"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport { Link, withRouter, Redirect } from 'react-router-dom';\nimport { useForm } from 'react-hook-form';\nimport './signUp.scss';\nimport { Alert } from 'antd';\nimport * as actions from '../../Redux/Actions/actions';\nimport ServiceApi from '../../services/serviceApi';\nimport { renderErrors } from './formsFunctions';\n\nfunction SignIn({ logIn, setErrorInMain, mainState, history }) {\n\tconst [ sucsessLog, setSucsessLog ] = useState(false);\n\n\tconst { register, handleSubmit, errors } = useForm();\n\tconst myService = new ServiceApi();\n\tasync function onSubmit(data) {\n\t\ttry {\n\t\t\tconst response = await myService.sigIn({\n\t\t\t\tuser: {\n\t\t\t\t\temail: data.email,\n\t\t\t\t\tpassword: data.password\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (response.errors) {\n\t\t\t\treturn setErrorInMain(response.errors);\n\t\t\t} else {\n\t\t\t\tlogIn(response);\n\t\t\t\tsetSucsessLog(true);\n\n\t\t\t\treturn setTimeout(() => {\n\t\t\t\t\thistory.push('/');\n\t\t\t\t}, 1500);\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tconst response = await myService.sigIn({\n\t\t\t\tuser: {\n\t\t\t\t\temail: data.email,\n\t\t\t\t\tpassword: data.password\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (response.errors) {\n\t\t\t\treturn setErrorInMain(response.errors);\n\t\t\t} else {\n\t\t\t\tlogIn(response);\n\t\t\t\tsetSucsessLog(true);\n\t\t\t\treturn setTimeout(() => {\n\t\t\t\t\thistory.push('/');\n\t\t\t\t}, 1500);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn (\n\t\t<div className=\"sign_up\">\n\t\t\t<form onSubmit={handleSubmit(onSubmit)} className=\"sign_up_form form\">\n\t\t\t\t<div className=\"form__header-container\">\n\t\t\t\t\t<h1 className=\"form__header\">Sign In</h1>\n\t\t\t\t</div>\n\t\t\t\t<label className=\"form__input-group\">\n\t\t\t\t\t<span className=\"form__input-label\">Email address</span>\n\t\t\t\t\t<input\n\t\t\t\t\t\tautoFocus\n\t\t\t\t\t\ttype=\"email\"\n\t\t\t\t\t\tname=\"email\"\n\t\t\t\t\t\tplaceholder=\"Email address\"\n\t\t\t\t\t\tclassName=\"form__input\"\n\t\t\t\t\t\tref={register({\n\t\t\t\t\t\t\trequired: 'Введите email',\n\t\t\t\t\t\t\tpattern: {\n\t\t\t\t\t\t\t\tvalue: /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,}$/i,\n\t\t\t\t\t\t\t\tmessage: 'Введите корректный email'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})}\n\t\t\t\t\t/>\n\t\t\t\t\t{errors.email && (\n\t\t\t\t\t\t<span className=\"form__input-label form__input-label--error\">{errors.email.message}</span>\n\t\t\t\t\t)}\n\t\t\t\t</label>\n\t\t\t\t<label className=\"form__input-group\">\n\t\t\t\t\t<span className=\"form__input-label\">Password</span>\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\tname=\"password\"\n\t\t\t\t\t\tplaceholder=\"Password\"\n\t\t\t\t\t\tclassName=\"form__input\"\n\t\t\t\t\t\tref={register({\n\t\t\t\t\t\t\trequired: 'Введите пароль',\n\t\t\t\t\t\t\tminLength: { value: 6, message: 'Пароль должен быть от 6 до 40 символов' },\n\t\t\t\t\t\t\tmaxLength: { value: 40, message: 'Пароль должен быть от 6 до 40 символов' }\n\t\t\t\t\t\t})}\n\t\t\t\t\t/>\n\t\t\t\t\t{errors.password && (\n\t\t\t\t\t\t<span className=\"form__input-label form__input-label--error\">{errors.password.message}</span>\n\t\t\t\t\t)}\n\t\t\t\t</label>\n\n\t\t\t\t<button type=\"submit\" className=\"form__submit\">\n\t\t\t\t\tLogin\n\t\t\t\t</button>\n\t\t\t\t<div className=\"form__container\">\n\t\t\t\t\t<span className=\"form__text\">\n\t\t\t\t\t\tDon't have an account?{' '}\n\t\t\t\t\t\t<Link className=\"form__link\" to=\"/sign-up\">\n\t\t\t\t\t\t\tSign In.\n\t\t\t\t\t\t</Link>\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t{sucsessLog ? <Alert message=\"Success\" type=\"success\" style={{ marginBottom: '20px' }} /> : null}\n\t\t\t\t{mainState.error ? renderErrors(mainState.error) : null}\n\t\t\t</form>\n\t\t</div>\n\t);\n}\n\nconst mapStateToProps = (state) => {\n\treturn {\n\t\tmainState: state.mainReducer\n\t};\n};\n\nexport default withRouter(connect(mapStateToProps, actions)(SignIn));\n"]},"metadata":{},"sourceType":"module"}